<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record model="ir.ui.view" id="base_view_partner_inherit_form_inmerzo_view">
            <field name="name">base.view.partner.inherit.form.inmerzo.view</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.view_partner_form"/>
            <field name="arch" type="xml">
                <div name="button_box" position="inside">
                    <button class="oe_stat_button"  type="object" name="action_view_instance_planing" icon="fa-cubes" attrs="{'invisible': [('is_inmerzo', '!=', True)]}">
                        <field string="Instances" name="instance_count" widget="statinfo"/>
                    </button>
                    <button class="oe_stat_button"  type="object" name="action_view_partner_planing" icon="fa-align-justify" attrs="{'invisible': [('is_inmerzo', '!=', True)]}">
                        <field string="Planing" name="planing_count" widget="statinfo"/>
                    </button>
                </div>
                <xpath expr="//field[@name='vat']" position="after">
                    <field name="is_inmerzo" invisible="True"/>
                </xpath>
                <xpath expr="//field[@name='email']" position="attributes">
                    <attribute name="attrs">{'required':[('company_type','=','person'), ('parent_id','=', False)]}</attribute>
                </xpath>
            </field>
        </record>

        <record model="ir.actions.act_window" id="action_partner_inherit_form_inmerzo_view">
			<field name="name">Client</field>
			<field name="res_model">res.partner</field>
			<field name="view_mode">kanban,tree,activity,form</field>
            <field name="context">{'default_is_inmerzo': True}</field>
            <field name="domain">[('is_inmerzo','=',True)]</field>
		</record>

        <!-- View Form instance.client -->
        <record model="ir.ui.view" id="instance_client_form">
            <field name="name">instance.client.form</field>
            <field name="model">instance.client</field>
            <field name="arch" type="xml">
                <form string="Instance Client">
                    <header>
                        <field name="state" widget="statusbar" statusbar_visible="no_assigned,assigned"/>
                    </header>
                    <sheet>
                        <div name="button_box" class="oe_button_box">
                            <button id="instance_button" class="oe_stat_button" disabled="1">
                                <div role="img" class="fa fa-fw fa-circle text-muted o_button_icon" attrs="{'invisible': [('status', '!=', 'no_connect')]}" aria-label="Stop server" title="Stop server"/>
                                <div role="img" class="fa fa-fw fa-circle text-success o_button_icon" attrs="{'invisible': [('status', '!=', 'connect')]}" aria-label="Running server" title="Running server"/>
                                <div role="img" class="fa fa-fw fa-circle text-warning o_button_icon" attrs="{'invisible': [('status', '!=', 'waiting')]}" aria-label="Waiting server" title="Waiting server"/>
                                <div role="img" class="fa fa-fw fa-circle text-danger o_button_icon" attrs="{'invisible': [('status', '!=', 'down')]}" aria-label="Down server" title="Down server"/>
                            </button>
                        </div>
                        <div class="oe_title">
                            <label for="name" class="oe_edit_only"/>
                            <h1><field name="name" placeholder="Instance Name" readonly="True"/></h1>
                        </div>
                        <group>
                            <group>
                                <field name="partner_id" domain="[('is_inmerzo', '=', True)]" required="True" options="{'no_create': True, 'no_open': True}"/>
                                <field name="user" required="True" options="{'no_create': True, 'no_open': True}"/>
                                <field name="status" invisible="True"/>
                            </group>
                            <group>
                                <field name="docker_id" required="True" options="{'no_create': True, 'no_open': True}"/>
                                <field name="url" required="True"/>
                                <field name="size_docker" required="True"/>
                            </group>
                        </group>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids"/>
                        <field name="activity_ids"/>
                        <field name="message_ids"/>
                    </div>
                </form>
            </field>
        </record>

        <!-- View Tree instance.client -->
        <record model="ir.ui.view" id="instance_client_tree">
            <field name="name">instance.client.tree</field>
            <field name="model">instance.client</field>
            <field name="arch" type="xml">
                <tree string="Instance Client" decoration-muted = "state == 'no_assigned'" sample="1">
                    <field name="name"/>
                    <field name="partner_id"/>
                    <field name="url"/>
                    <field name="docker_id"/>
                    <field name="status"/>
                    <field name="state" widget="badge" decoration-info="state == 'draft'" decoration-muted = "state == 'cancel'"/>
                </tree>
            </field>
        </record>

        <!-- View kanban instance.client -->
        <record id="instance_client_dashboard_kanban" model="ir.ui.view">
            <field name="name">instance.client.kanban</field>
            <field name="model">instance.client</field>
            <field name="arch" type="xml">
                <kanban create="false" class="oe_background_grey o_kanban_dashboard o_account_kanban" js_class="account_dashboard_kanban">
                    <field name="name"/>
                    <field name="color"/>
                    <field name="partner_id"/>
                    <field name="url"/>
                    <field name="docker_id"/>
                    <field name="size_docker"/>
                    <field name="status"/>
                    <field name="state"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div t-attf-class="oe_kanban_color_#{kanban_getcolor(record.color.raw_value)} oe_kanban_card oe_semantic_html_override">
                                <div t-attf-class="o_kanban_card_header">
                                    <div class="o_kanban_card_header_title">
                                        <strong class="o_kanban_record_title">
                                            <div class="float-right">
                                                <span class="fa fa-circle text-muted" t-if="record.status.raw_value == 'no_connect'" role="img" aria-label="Stop server" title="Stop server">
                                                </span>
                                                <span class="fa fa-circle text-success" t-if="record.status.raw_value == 'connect'" role="img" aria-label="Running server" title="Running server">
                                                </span>
                                                <span class="fa fa-circle text-warning" t-if="record.status.raw_value == 'waiting'" role="img" aria-label="Waiting server" title="Waiting server">
                                                </span>
                                                <span class="fa fa-circle text-danger" t-if="record.status.raw_value == 'down'" role="img" aria-label="Down server" title="Down server">
                                                </span>
                                            </div>
                                        </strong>
                                        <div class="o_primary" t-if="!selection_mode">
                                            <a t-if="widget.editable" type="edit">
                                                <field name="name"/>
                                            </a>
                                        </div>
                                        <div class="o_primary" t-if="selection_mode">
                                            <field name="name"/>
                                        </div>
                                        <br/>
                                        <div class="o_secondary"><field class="o_secondary" name="planing_id" readonly="1"/></div>
                                        <div class="o_secondary"><field class="o_secondary" name="partner_id" readonly="1"/></div>
                                    </div>
                                </div>
                                <div class="container o_kanban_card_content">
                                    <div class="row">
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <record id="action_instance_client" model="ir.actions.act_window">
            <field name="name">Instance Client</field>
            <field name="res_model">instance.client</field>
            <field name="view_mode">kanban,tree,form</field>
            <field name="view_ids"
                   eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'kanban', 'view_id': ref('instance_client_dashboard_kanban')}),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('instance_client_tree')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('instance_client_form')})]"/>
        </record>

        <!-- View Form docker.build -->
        <record model="ir.ui.view" id="docker_build_form">
            <field name="name">docker.build.form</field>
            <field name="model">docker.build</field>
            <field name="arch" type="xml">
                <form string="Docker Build">
                    <header>
                        <field name="status" widget="statusbar" statusbar_visible="no_connect,connect,waiting,down"/>
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <label for="name" class="oe_edit_only"/>
                            <h1><field name="name" placeholder="Name Docker" readonly="True" required="True"/></h1>
                        </div>
                        <group>
                            <group>
                                <field name="partner_id" required="True" options="{'no_create': True, 'no_open': True}"/>
                                <field name="url" required="True"/>
                            </group>
                            <group>
                                <field name="size_docker" required="True"/>
                            </group>
                        </group>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids"/>
                        <field name="activity_ids"/>
                        <field name="message_ids"/>
                    </div>
                </form>
            </field>
        </record>

        <!-- View Tree docker.build -->
        <record model="ir.ui.view" id="docker_build_tree">
            <field name="name">docker.build.tree</field>
            <field name="model">docker.build</field>
            <field name="arch" type="xml">
                <tree string="Docker Build" decoration-muted="status == 'no_connect'">
                    <field name="name"/>
                    <field name="partner_id"/>
                    <field name="url"/>
                    <field name="size_docker"/>
                    <field name="status" widget="badge" decoration-success="status == 'connect'" decoration-muted="status == 'no_connect'" decoration-danger="status == 'down'" decoration-warning="status == 'waiting'"/>
                </tree>
            </field>
        </record>

        <record id="action_docker_build" model="ir.actions.act_window">
            <field name="name">Docker Build</field>
            <field name="res_model">docker.build</field>
            <field name="view_mode">tree,form</field>
            <field name="view_ids"
                   eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('docker_build_tree')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('docker_build_form')})]"/>
        </record>

        <!-- View Form docker.image -->
        <record model="ir.ui.view" id="docker_image_form">
            <field name="name">docker.image.form</field>
            <field name="model">docker.image</field>
            <field name="arch" type="xml">
                <form string="Docker Image">
                    <header>
                        <field name="status" widget="statusbar" statusbar_visible="not_used,used"/>
                    </header>
                    <sheet>
                        <div name="button_box" class="oe_button_box">
                            <button class="oe_stat_button"  type="object" name="action_view_container" icon="fa fa-image">
                                <field string="Containers" name="container_count" widget="statinfo"/>
                            </button>
                        </div>
                        <div class="oe_title">
                            <label for="name" class="oe_edit_only"/>
                            <h1><field name="name" placeholder="Name Image" readonly="True" required="True"/></h1>
                        </div>
                        <group>
                            <group>
                                <field name="display_name" required="True"/>
                                <field name="type_image" required="True"/>
                                <field name="image_id" required="True"/>
                            </group>
                            <group>
                                 <field name="tag_image" required="True" widget="many2many_tags" options="{'color_field': 'color'}"/>
                                <field name="size_image" required="True"/>
                            </group>
                            <group>
                                <field name="create_date" readonly="True"/>
                                <field name="write_uid" readonly="True"/>
                            </group>
                            <group>
                            </group>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <!-- View Tree docker.image -->
        <record model="ir.ui.view" id="docker_image_tree">
            <field name="name">docker.image.tree</field>
            <field name="model">docker.image</field>
            <field name="arch" type="xml">
                <tree string="Docker Image" decoration-muted= "status == 'not_used'">
                    <field name="name" optional="hide"/>
                    <field name="display_name"/>
                    <field name="type_image"/>
                    <field name="image_id"/>
                    <field name="tag_image" widget="many2many_tags" options="{'color_field': 'color'}"/>
                    <field name="size_image"/>
                    <field name="create_date" widget="remaining_days"/>
                    <field name="write_uid" widget="many2one_avatar_user"/>
                    <field name="status" widget="badge" decoration-success="status == 'used'" decoration-muted="status == 'not_used'"/>
                </tree>
            </field>
        </record>

        <record id="action_docker_image" model="ir.actions.act_window">
            <field name="name">Docker Image</field>
            <field name="res_model">docker.image</field>
            <field name="view_mode">tree,form</field>
            <field name="view_ids"
                   eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('docker_image_tree')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('docker_image_form')})]"/>
        </record>

        <!-- View Form docker.container -->
        <record model="ir.ui.view" id="docker_container_form">
            <field name="name">docker.container.form</field>
            <field name="model">docker.container</field>
            <field name="arch" type="xml">
                <form string="Docker Container">
                    <header>
                        <field name="status" widget="statusbar" statusbar_visible="no_connect,connect,waiting,down"/>
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <label for="name" class="oe_edit_only"/>
                            <h1><field name="name" placeholder="Name Image" readonly="True" required="True"/></h1>
                        </div>
                        <group>
                            <group>
                                <field name="image_id" required="True" options="{'no_create': True, 'no_open': True}"/>
                                <field name="type_image" invisible="1"/>
                            </group>
                            <group>
                                <field name="create_date" readonly="True"/>
                                <field name="write_uid" readonly="True"/>
                            </group>
                            <group name="environment" string="Environment">
                                <field name="po_db" placeholder="Ex. postgres" attrs="{'invisible': [('type_image', '!=', 'po')]}" readonly="True"/>
                                <field name="po_pass" placeholder="Ex. odoo" attrs="{'invisible': [('type_image', '!=', 'po')]}" readonly="True"/>
                                <field name="po_user" placeholder="Ex. odoo" attrs="{'invisible': [('type_image', '!=', 'po')]}" readonly="True"/>
                                <field name="pg_data" placeholder="Ex. /var/lib/..." attrs="{'invisible': [('type_image', '!=', 'po')]}" readonly="True"/>
                                <field name="path_route" placeholder="Ex. /usr/local/..." readonly="True"/>
                                <field name="go_version" placeholder="Ex. 1.1" attrs="{'invisible': [('type_image', '!=', 'po')]}" readonly="True"/>
                                <field name="lang_id" placeholder="Ex. C.UTF-8 or en_US.utf8" readonly="True"/>
                                <field name="pg_major" placeholder="Ex. 13" attrs="{'invisible': [('type_image', '!=', 'po')]}" readonly="True"/>
                                <field name="pg_version" placeholder="Ex. 13.3-1.pgdg100+1" attrs="{'invisible': [('type_image', '!=', 'po')]}" readonly="True"/>
                                <field name="o_version" placeholder="Ex. 14.0" attrs="{'invisible': [('type_image', '!=', 'od')]}" readonly="True"/>
                                <field name="o_rc" placeholder="Ex. /etc/odoo/odoo.conf" attrs="{'invisible': [('type_image', '!=', 'od')]}" readonly="True"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Mounts and Ports">
                                <h3>Mounts</h3>
                                <field name="volume_ids">
                                    <tree editable="bottom">
                                        <field name="name"/>
                                        <field name="size_volume"/>
                                        <field name="create_date" widget="remaining_days"/>
                                        <field name="write_uid" widget="many2one_avatar_user"/>
                                    </tree>
                                </field>
                                <h3>Ports</h3>
                                <field name="ports_ids">
                                    <tree editable="bottom">
                                        <field name="name"/>
                                        <field name="related_name"/>
                                        <field name="create_date" widget="remaining_days"/>
                                        <field name="write_uid" widget="many2one_avatar_user"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

        <!-- View Tree docker.container -->
        <record model="ir.ui.view" id="docker_container_tree">
            <field name="name">docker.container.tree</field>
            <field name="model">docker.container</field>
            <field name="arch" type="xml">
                <tree string="Docker Container" decoration-muted= "status == 'no_connect'">
                    <field name="name"/>
                    <field name="image_id"/>
                    <field name="path_route"/>
                    <field name="lang_id"/>
                    <field name="volume_ids"/>
                    <field name="ports_ids"/>
                    <field name="create_date" widget="remaining_days"/>
                    <field name="write_uid" widget="many2one_avatar_user"/>
                    <field name="status" widget="badge" decoration-success="status == 'connect'" decoration-muted="status == 'no_connect'" decoration-danger="status == 'down'" decoration-warning="status == 'waiting'"/>
                </tree>
            </field>
        </record>

        <record id="action_docker_container" model="ir.actions.act_window">
            <field name="name">Docker Container</field>
            <field name="res_model">docker.container</field>
            <field name="view_mode">tree,form</field>
            <field name="view_ids"
                   eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('docker_container_tree')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('docker_container_form')})]"/>
        </record>

        <menuitem id="menu_partner_client_inmerzo" name="Clients" parent="principal_planing_client_menu_item" action="action_partner_inherit_form_inmerzo_view" sequence="2"/>
        <menuitem id="menu_instance_client" name="Instances" parent="instance_client_menu_item" action="action_instance_client" sequence="2"/>
        <menuitem id="menu_docker_build" name="Docker Build" parent="instance_client_menu_item" action="action_docker_build" sequence="3"/>
        <menuitem id="menu_docker_container" name="Docker Container" parent="instance_client_menu_item" action="action_docker_container" sequence="4"/>
        <menuitem id="menu_docker_volumes" name="Docker Volumes" parent="instance_client_menu_item" action="action_docker_image" sequence="5"/>
        <menuitem id="menu_docker_image" name="Docker Image" parent="instance_client_menu_item" action="action_docker_image" sequence="6"/>
    </data>
</odoo>
